<div class="admin-reports-container">
  @if (isloading) {
    <div class="loading-spinner">
      <div class="spinner"></div>
    </div>
  }

  <div class="dashboard-summary">
    <h2>ملخص لوحة التحكم</h2>
    <div class="summary-cards">
      <div class="summary-card">
        <h3>إجمالي المستخدمين</h3>
        <p>{{ dashboardData.totalUsers || 0 }}</p>
      </div>
      <div class="summary-card">
        <h3>إجمالي المعلمين</h3>
        <p>{{ dashboardData.totalTeachers || 0 }}</p>
      </div>
      <div class="summary-card">
        <h3>إجمالي الطلاب</h3>
        <p>{{ dashboardData.totalStudents || 0 }}</p>
      </div>
      <div class="summary-card">
        <h3>إجمالي الحلقات</h3>
        <p>{{ dashboardData.totalHalaqas || 0 }}</p>
      </div>
      <div class="summary-card">
        <h3>معدل الحضور</h3>
        <p>{{ dashboardData.overallAttendanceRate ? (dashboardData.overallAttendanceRate | number:'1.0-2') : '0.00' }} %</p>

      </div>
      <div class="summary-card">
        <h3>المنضمون الجدد للحلقات هذا الشهر</h3>
        <p>{{ dashboardData.newjoinToHalaqaThisMonth || 0 }}</p>
      </div>
    </div>
  </div>

  <div class="report-section">
    <h2>ملخص المستخدمين</h2>
    <table class="data-table">
      <thead>
        <tr >
          <!-- <th  class="text-end">الرقم</th> -->
          <th  class="text-end">الاسم الكامل</th>
          <th  class="text-end">البريد الإلكتروني</th>
          <th  class="text-end">الدور</th>
          <th  class="text-end">الحالة</th>
        </tr>
      </thead>
      <tbody>
        @for (user of UserSummaryData; track user.userId) {
          <tr>
            <!-- <td>{{ user.userId }}</td> -->
            <td>{{ user.fullName }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.role }}</td>
            <td [class.active]="user.isActive" [class.inactive]="!user.isActive">
              {{ user.isActive ? 'نشط' : 'غير نشط' }}
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- جدول أداء المعلمين -->
  <div class="report-section">
    <h2>أداء المعلمين</h2>
    <table class="data-table">
      <thead>
        <tr>
          <!-- <th class="text-end">الرقم</th> -->
          <th class="text-end">الاسم</th>
          <th class="text-end">البريد الإلكتروني</th>
          <th class="text-end">الحلقات</th>
          <th class="text-end">متوسط الحضور</th>
          <th class="text-end">متوسط اسطر الحفظ </th>
        </tr>
      </thead>
      <tbody>
        @for (teacher of TeacherPerformanceData; track teacher.teacherId) {
          <tr>
            <!-- <td>{{ teacher.teacherId }}</td> -->
            <td>{{ teacher.teacherName }}</td>
            <td>{{ teacher.email }}</td>
            <td>{{ teacher.totalAssignedHalaqas }}</td>
            <td>{{ teacher.averageAttendanceRate | number:'1.0-2' }}%</td>
            <td>{{ teacher.averageStudentProgress | number:'1.0-2' }}</td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- جدول أداء الطلاب -->
  <div class="report-section">
    <h2>أداء الطلاب</h2>
    <table class="data-table">
      <thead>
        <tr>
          <!-- <th class="text-end">الرقم</th> -->
          <th class="text-end">الاسم</th>
          <th class="text-end">البريد الإلكتروني</th>
          <th class="text-end">نسبه الحضور</th>
          <th class="text-end">اجمالي المحفوظ </th>
          <th class="text-end">اجمالي المراجعه</th>
          <th class="text-end">اجمالي الصفحات في العلوم الشرعيه</th>
        </tr>
      </thead>
      <tbody>
        @for (student of StudentPerformanceData; track student.studentId) {
          <tr>
            <!-- <td>{{ student.studentId }}</td> -->
            <td>{{ student.studentName }}</td>
            <td>{{ student.email }}</td>
            <td>{{ student.attendanceRate | number:'1.0-2' }}%</td>
            <td>{{ student.totalQuranLinesMemorized }}</td>
            <td>{{ student.totalQuranLinesReviewed }}</td>
            <td>{{ student.totalIslamicPagesCompleted }}</td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- جدول صحة الحلقات -->
  <div class="report-section">
    <h2>متابعه الحلقات</h2>
    <table class="data-table">
      <thead>
        <tr>
          <!-- <th class="text-end">الرقم</th> -->
          <th class="text-end">الاسم</th>
          <th class="text-end">الطلاب</th>
          <th class="text-end">المعلمين</th>
          <th class="text-end">متوسط الحضور</th>
          <th class="text-end">متوسط اسطر الحفظ و المراجعه</th>
        </tr>
      </thead>
      <tbody>
        @for (halaqa of HalaqaHealthData; track halaqa.halaqaId) {
          <tr>
            <!-- <td>{{ halaqa.halaqaId }}</td> -->
            <td>{{ halaqa.halaqaName }}</td>
            <td>{{ halaqa.studentCount }}</td>
            <td>{{ halaqa.teacherCount }}</td>
            <td>{{ halaqa.averageAttendanceRate  | number:'1.0-2'}}%</td>
            <td>{{ halaqa.averageProgress | number:'1.0-2' }}</td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
